var LinkNotification = LinkNotification || {}; LinkNotification = function () {
    return startConnection = function (n, t) {
        var i = function (t, i, r, u, f, e, o) { var s, h, c; try { if (s = "", s = o ? " đã thêm một file " : f, h = "", h = e != "" ? n + "/api/Profile/getUserProfilePhoto/" + e + " " : n + "/images/default-image.svg ", !Notification) { alert("Desktop notifications not available in your browser. Try Chromium."); return } Notification.permission !== "granted" ? Notification.requestPermission() : (c = new Notification(u, { icon: h, body: s }), c.onclick = function () { window.open(n + "/comments/Comment/" + t + "/" + i + "/" + r) }) } catch (l) { } }, r = function (i, r, u, f, e, o, s) { var h, c, l; try { if (h = "", h = o ? " sent an attachment " : u, c = "", c = e != "" ? n + "/api/Profile/getUserProfilePhoto/" + e + " " : n + "/images/default-image.svg ", !Notification) { alert("Desktop notifications not available in your browser. Try Chromium."); return } Notification.permission !== "granted" ? Notification.requestPermission() : (l = new Notification(r, { icon: c, body: h }), l.onclick = function () { register_popup(f, i, n, t, s) }) } catch (a) { } }; notificationConnection = (new signalR.HubConnectionBuilder).withUrl(n + "/notificationHub").build(); notificationConnection.on("RefreshChatNotificationNum", function (t, i) {
            var u; $("#main-chat-notification-num").text(t); i.commentGroupTypeId == "5" ?
                (u = i.creatorName + " đã gửi một tin nhắn đến bạn.",
                    r(i.creatorName, u, i.content, i.groupId, i.creator, i.fileURL != null, 5)) : i.commentGroupTypeId == "4" && (u = i.creatorName + " sent a message to group " + i.groupName, r(i.groupName, u, i.content, i.groupId, i.creator, i.fileURL != null, 4)); jQuery.inArray(i.groupId, popups) !== -1 && (window["popup-comment-" + i.groupId].appendNewComment(i), $("#popup-comment-" + i.groupId).scrollTop($("#popup-comment-" + i.groupId)[0].scrollHeight), $.ajax({ type: "put", url: n + "/api/Notifications/setNotificationAsRead/" + i.groupId + "/1", success: function () { $.ajax({ type: "get", url: n + "/api/Notifications/notificationsNo/1", success: function (n) { $("#main-chat-notification-num").text(n) } }) } }))
        }); notificationConnection.on("RefreshGeneralNotificationNum", function (n, t) { var r; $("#main-notification-num").text(n); t != null && (t.parent == null ? t.commentGroupTypeId == "1" ? (window["profile-comments-container-" + t.groupId] !== undefined && window["profile-comments-container-" + t.groupId].prependNewComment(t), r = t.creatorName + " add an post", i(t.id, t.groupId, 1, r, t.content, t.creator, t.fileURL != null)) : t.commentGroupTypeId == "2" && (window["group-comments-container-" + t.groupId] !== undefined && window["group-comments-container-" + t.groupId].prependNewComment(t), r = t.creatorName + " add an post to group " + t.groupName, i(t.id, t.groupId, 2, r, t.content, t.creator, t.fileURL != null)) : t.commentGroupTypeId == "1" ? (window["profile-comments-container-" + t.groupId] !== undefined && window["profile-comments-container-" + t.groupId].prependNewComment(t), r = t.creatorName + " add an reply", i(t.id, t.groupId, 1, r, t.content, t.creator, t.fileURL != null)) : t.commentGroupTypeId == "2" && (window["group-comments-container-" + t.groupId] !== undefined && window["group-comments-container-" + t.groupId].prependNewComment(t), r = t.creatorName + " add an reply to group " + t.groupName + " post ", i(t.id, t.groupId, 2, r, t.content, t.creator, t.fileURL != null))) }); notificationConnection.on("RefreshFollowersNotificationNum", function (n) { $("#main-follower-notification-num").text(n) }); notificationConnection.start()
    }, { startConnection: startConnection }
}();